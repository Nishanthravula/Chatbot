<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>#Crawlers-bot</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
   
  <script src='main.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
      var query = '';
      var topic = '';
//       const selectableOptions = [
//   { value: 'Politics',label: 'Politics' },
//   { value: 'Health care',label:'Healthcare' },
//   { value: 'Education',label:'Education' },
//   { value: 'Technology', label:'Technology' },
//   { value: 'Environment', label:'Environment' },
//   { value: 'All', label: 'All'},
//   { value: 'Chitchat', label: 'Chitchat'}
      // goToDiv();

    function goToDiv(){
      console.log("dummy", $('div#dummy'));
  //     var etop = $('#checkDiv').offset().top;
	// $(window).scrollTop(etop);
    // $('html, body').animate({
    //         scrollTop: $("div#dummy").offset().top
    //     }, 1000);
        document.getElementById('dummy').scrollIntoView();
    }
// document.getElementById('checkDiv').scrollIntoView();
// ]
      function changeTopic(arg){
        topic = arg;

      }
      
        function testFn(){
          
          $.ajax({
                    type: "POST",
                    url: "/bot",
                    data: JSON.stringify({
    "query":query,
    "topic":topic,
    
}),
contentType: "application/json",
                    success: function (response) {
        console.log(response);
                    },
                    error: function (error) {
                        console.log(error);
                    }
                });

        }
        function formatDate(date) {
      const h = "0" + date.getHours();
      const m = "0" + date.getMinutes();

      return `${h.slice(-2)}:${m.slice(-2)}`;
    }
        function updatequery(e){
          // console.log("e", e);
          if(e.key == "Enter"){
            query = document.getElementById('query_text').value;
            document.getElementById('query_text').value = ''
            console.log("query", document.getElementById('query_text').value);
                      document.getElementById('messages').insertAdjacentHTML('beforeend', '<br>'+`<div class="msg_div message-container animate__animated animate__bounceInUp" id="query_div">
                                                                                                  <div class="user-image">  <img src="{{url_for('static', filename='user.png')}}" /></div>
                                                                                                    <div class="user-message ">
                                                                                                      <div class="info">
                                                                                                          
                                                                                                          <div class="msg-info-name">User</div> 
                                                                                                          <div class="msg-info-time">${formatDate(new Date())}</div>
                                                                                                      </div>
                                                                                                        <div class="querymsg">`+query+`</div>
                                                                                                          
                                                                                                          </div>
                                                                              </div>`);
            $.ajax({
                    type: "POST",
                    url: "/bot",
                    data: JSON.stringify({
    "query":query,
    "topic":topic
}),
contentType: "application/json",
                    success: function (response) {
                      document.getElementById('messages').insertAdjacentHTML('beforeend', '<br>'+`   <div class="msg_div message-container animate__animated animate__bounceInUp" id="response_div">
                    

                                                                                                        <div class="bot-image">  <img src="{{url_for('static', filename='robot.png')}}" /></div>
                                                                                                            
                                                                                                        <div class="bot-message ">
                                                                                                          
                                                                                                          <div class="info">
                                                                                                            
                                                                                                            <div class="msg-info-name">BOT</div> 
                                                                                                            <div class="msg-info-time">${formatDate(new Date())}</div>
                                                                                                          </div>
                                                                                                          <div class="responsemsg" id="bottest">`+response+` </div>
                                                                                                          
                                                                                                          </div>
                                                                                                        
                                                                                                        
                                                                                                      </div>`);
        console.log(response);
        goToDiv();


                    },
                    error: function (error) {
                        console.log(error);
                    },
                    complete: function(){
                      console.log("I'm in complete");
                      // sleep(5000);
                      // document.getElementById('dummy').scrollIntoView();
                    }
                });
          }
        }
      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
//       $("#button").click(function() {
//     $('html, body').animate({
//         scrollTop: $("#dummy").offset().top
//     }, 2000);
// });
    </script>
</head>

<style>
  body{
  background-image: url(https://wallpapercave.com/wp/wp9857146.jpg);
 
  font-family: 'Source Sans Pro', sans-serif;
  
}
::-webkit-scrollbar {
  width: 10px;
  border-radius: 8px;
}

/* Track */
::-webkit-scrollbar-track {
  background: #f1f1f1; 
}
 
/* Handle */
::-webkit-scrollbar-thumb {
  background: #888; 
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  background: #555; 
}
.chatbot {
  
  border-radius: 10px;
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);
  text-align: center;
  display: flex;
  flex-flow: column;
  overflow: hidden;
  /* overflow-y: scroll; */

  margin: auto;
  width: 50%;
  height: 90vh;
  backdrop-filter: blur(10px);
  background-color: rgba(255, 255, 255, 0.5);
  background-image: url('https://i.pinimg.com/736x/8c/98/99/8c98994518b575bfd8c949e91d20548b.jpg');
}
.message-container {
  width: 100%;
}
.input {
  position: relative;
}
.input_field{
  position: absolute;
    width: inherit;
    bottom: 0;
}
.input{
  font-family: monospace;
  font-size: 16px;
  border: 0;
  border-radius: 0;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
  border-top: 1px solid #eee;
  box-shadow: none;
  box-sizing: border-box;
  opacity: 1;
  outline: none;
  padding: 16px 52px 16px 10px;
  width: 100%;
  -webkit-appearance: none;
  z-index: 999;

}
button {
  background-color: transparent;
  border: 0;
  border-bottom-right-radius: 10px;
  box-shadow: none;
  cursor: pointer;
  fill: #4a4a4a;
  opacity: 1;
  outline: none;
  padding: 14px 16px 12px 16px;
  position: absolute;
  right: 0;
  z-index: 9999;
  /* top: 0; */
}
.user-message {
  float: right;
  padding: 15px 10px;
  margin: 0 5px;
  border-radius: 20px 20px 1px 20px;
  background: #cccccc;
  color: black;
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);
  display: flex;
    flex-direction: column;
}
.querymsg, .responsemsg{
  text-align: left;
}
.bot-message {
  float: left;
  padding: 15px 20px;
  margin: 0 5px;
  border-radius: 20px 20px 20px 1px;
  box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.15);
  background-color: rgba(140, 0, 255, 0.61);
  -webkit-backdrop-filter: blur(5px);
  backdrop-filter: blur(5px);
  color: white;
  min-width: 40px;
  display: flex;
    flex-direction: column;
}
.msg-info-name{
  float: left;
  margin-right: 1vw;
}
.msg-info-time{
  float: right;
}
.msg-info-time, .msg-info-name{
  font-size: 11px;
    padding-bottom: 3px;
  
}
.header {
  padding: 20px;
  text-align: center;
  color: rgb(255, 255, 255);
  max-height: 58px;
  font-size: 12px;
  font-weight: bold;
  background-color: #000000;
}

.messages {
  width: 100%;
  height: 67vh;
  overflow: auto;
  display: flex;
  flex-direction: column;
  padding: 5px 0px;
  /* overflow:scroll; */
scroll-behavior: auto;
  
}
.selection{
  margin: 2px;
  z-index: 999;
  position: relative;
  background-image: url(https://i.pinimg.com/736x/8c/98/99/8c98994â€¦.jpg);
}
.bot-image{
  float: left;
}
.bot-image img{
  margin-top: 26px;
  width: 40px;

}

.user-image img{
  margin-top: 26px;
  float: right;
  width: 40px;

}
</style>
<body>

  <button style="background-color: #000000;color: #cccccc;" onclick="goToDiv()">Test</button>
  <!-- <div id="testDiv" style="max-height: 200px;overflow: auto;">
    <button style="background-color: #000000;color: #cccccc;" onclick="goToDiv()">Test</button>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    Report<br>
    <div class="checkDiv" id="checkDiv">MAIN</div>
  </div> -->
    <div class="chatbot">

    <div class="header">
      <h1>#Crawlers-bot</h1>
    </div>
  <div class="messages" id="messages">
    
    <div class="msg_div message-container animate__animated animate__bounceInUp" id="response_div">
      <div class="bot-image">  <img src="{{url_for('static', filename='robot.png')}}" /></div>
      <div class="bot-message ">Welcome to #Crawlers-bot</div>
    </div>
 
    <div class="input_field">

      <div class="selection">
        <input type="radio" name="topic" onclick="changeTopic('All')" checked><strong>All</strong></input>
        <input type="radio" name="topic" onclick="changeTopic('Chitchat')"> <strong>ChitChat</input>
     
        <input type="radio" name="topic" onclick="changeTopic('Politics')"> <strong>Politics</input>
        <input type="radio" name="topic" onclick="changeTopic('Environment')"><strong> Environment</input>
        <input type="radio" name="topic" onclick="changeTopic('Technology')"><strong> Technology</input>
        <input type="radio" name="topic" onclick="changeTopic('Healthcare')"><strong> Health Care</input>
        <input type="radio" name="topic" onclick="changeTopic('Education')"><strong> Education</input><br>
      </div>
      <div class="dummy" id="dummy" >

      </div>
    <input class="input" type="text" onkeypress="updatequery(event)" id="query_text" placeholder="Enter your message here.."/>
    <button onclick="updatequery({'key': 'Enter'})">
      
      <svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 500 500"
      >
        <g>
          <g>
            <polygon points="0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75" />
          </g>
        </g>
      </svg>
    </button>
  <br>
  </div>
  </div>
  </div>
</body>
</html>